{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/kiyotoka/Desktop/PRANA/components/admin/AmbulanceTracker.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { Ambulance, Incident } from '@/lib/types';\nimport { AMBULANCE_STATUSES } from '@/lib/mock-data';\n\ninterface AmbulanceTrackerProps {\n  ambulances: Ambulance[];\n  incidents: Incident[];\n  className?: string;\n}\n\nexport function AmbulanceTracker({ ambulances, incidents, className }: AmbulanceTrackerProps) {\n  const [map, setMap] = useState<L.Map | null>(null);\n  const [markers, setMarkers] = useState<Map<string, L.Marker>>(new Map());\n\n  useEffect(() => {\n    const mapContainer = document.getElementById('admin-ambulance-map');\n    if (!mapContainer) return;\n    \n    if ((mapContainer as any)._leaflet_id) {\n       (mapContainer as any)._leaflet_id = null;\n    }\n\n    const newMap = L.map('admin-ambulance-map', {\n        zoomControl: false,\n        attributionControl: false\n      }).setView([12.9716, 77.5946], 12);\n\n    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n      maxZoom: 19,\n    }).addTo(newMap);\n\n    setMap(newMap);\n\n    return () => {\n      newMap.remove();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!map) return;\n\n    const newMarkers = new Map<string, L.Marker>();\n\n    // Mock heatmap data to match the design (Red, Yellow, Green points in city center)\n    const drawHeatmapMocks = () => {\n       const center = [12.9716, 77.5946];\n       for(let i=0; i<300; i++) {\n          const lat = center[0] + (Math.random() - 0.5) * 0.08;\n          const lng = center[1] + (Math.random() - 0.5) * 0.08;\n          const dist = Math.sqrt(Math.pow(lat - center[0], 2) + Math.pow(lng - center[1], 2));\n          let color = '#22c55e'; // Green\n          if(dist < 0.02) color = '#ef4444'; // Red\n          else if(dist < 0.04) color = '#eab308'; // Yellow\n          \n          L.circle([lat, lng], { radius: 150, color: 'none', fillColor: color, fillOpacity: 0.4 }).addTo(map);\n       }\n    };\n    \n    drawHeatmapMocks();\n\n    ambulances.forEach((ambulance) => {\n      const incident = incidents.find((inc) => inc.ambulanceId === ambulance.id && inc.status !== 'completed');\n      const hasActiveIncident = !!incident;\n\n      const icon = L.icon({\n        iconUrl: hasActiveIncident\n          ? 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik05IDIyQzkuNTUyMjggMjIgMTAgMjEuNTUyMyAxMCAyMUMxMCAyMC40NDc3IDkuNTUyMjggMjAgOSAyMEM4LjQ0NzcyIDIwIDggMjAuNDQ3NyA4IDIxQzggMjEuNTUyMyA4LjQ0NzcyIDIyIDkgMjJaIiBmaWxsPSIjZGMyNjI2Ii8+PHBhdGggZD0iTTE2IDIyQzE2LjU1MjMgMjIgMTcgMjEuNTUyMyAxNyAyMUMxNyAyMC40NDc3IDE2LjU1MjMgMjAgMTYgMjBDMTUuNDQ3NyAyMCAxNSAyMC40NDc3IDE1IDIxQzE1IDIxLjU1MjMgMTUuNDQ3NyAyMiAxNiAyMloiIGZpbGw9IiNkYzI2MjYiLz48cGF0aCBkPSJNNSA5SDE2VjE5SDVWOVoiIHN0cm9rZT0iI2RjMjYyNiIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggZD0iTTIgOEw1IDE0SDE5TDIyIDhIMjFWNkg3VjhIMnoiIHN0cm9rZT0iI2RjMjYyNiIgc3Ryb2tlLXdpZHRoPSIyIi8+PC9zdmc+'\n          : 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik05IDIyQzkuNTUyMjggMjIgMTAgMjEuNTUyMyAxMCAyMUMxMCAyMC40NDc3IDkuNTUyMjggMjAgOSAyMEM4LjQ0NzcyIDIwIDggMjAuNDQ3NyA4IDIxQzggMjEuNTUyMyA4LjQ0NzcyIDIyIDkgMjJaIiBmaWxsPSIjZmZmZmZmIi8+PHBhdGggZD0iTTE2IDIyQzE2LjU1MjMgMjIgMTcgMjEuNTUyMyAxNyAyMUMxNyAyMC40NDc3IDE2LjU1MjMgMjAgMTYgMjBDMTUuNDQ3NyAyMCAxNSAyMC40NDc3IDE1IDIxQzE1IDIxLjU1MjMgMTUuNDQ3NyAyMiAxNiAyMloiIGZpbGw9IiNmZmZmZmYiLz48cGF0aCBkPSJNNSA5SDE2VjE5SDVWOVoiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggZD0iTTIgOEw1IDE0SDE5TDIyIDhIMjFWNkg3VjhIMnoiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+PC9zdmc+',\n        iconSize: [32, 32],\n        iconAnchor: [16, 32],\n        popupAnchor: [0, -32],\n      });\n\n      const marker = L.marker([ambulance.location.latitude, ambulance.location.longitude], {\n        icon,\n      })\n        .addTo(map)\n        .bindPopup(\n          `<strong>${ambulance.name}</strong><br/>${AMBULANCE_STATUSES[ambulance.status]}`\n        );\n\n      newMarkers.set(ambulance.id, marker);\n    });\n\n    setMarkers(newMarkers);\n  }, [map, ambulances, incidents]);\n\n  return (\n    <div className={className || \"w-full h-96 rounded-lg overflow-hidden border-2 border-gray-200\"}>\n      <div id=\"admin-ambulance-map\" className=\"w-full h-full bg-[#11131a]\" />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAGA;;;AANA;;;;;AAcO,SAAS,iBAAiB,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAyB;;IAC1F,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAe;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAwB,IAAI;IAElE,IAAA,0KAAS;sCAAC;YACR,MAAM,eAAe,SAAS,cAAc,CAAC;YAC7C,IAAI,CAAC,cAAc;YAEnB,IAAI,AAAC,aAAqB,WAAW,EAAE;gBACnC,aAAqB,WAAW,GAAG;YACvC;YAEA,MAAM,SAAS,+JAAC,CAAC,GAAG,CAAC,uBAAuB;gBACxC,aAAa;gBACb,oBAAoB;YACtB,GAAG,OAAO,CAAC;gBAAC;gBAAS;aAAQ,EAAE;YAEjC,+JAAC,CAAC,SAAS,CAAC,iEAAiE;gBAC3E,SAAS;YACX,GAAG,KAAK,CAAC;YAET,OAAO;YAEP;8CAAO;oBACL,OAAO,MAAM;gBACf;;QACF;qCAAG,EAAE;IAEL,IAAA,0KAAS;sCAAC;YACR,IAAI,CAAC,KAAK;YAEV,MAAM,aAAa,IAAI;YAEvB,mFAAmF;YACnF,MAAM;+DAAmB;oBACtB,MAAM,SAAS;wBAAC;wBAAS;qBAAQ;oBACjC,IAAI,IAAI,IAAE,GAAG,IAAE,KAAK,IAAK;wBACtB,MAAM,MAAM,MAAM,CAAC,EAAE,GAAG,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;wBAChD,MAAM,MAAM,MAAM,CAAC,EAAE,GAAG,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;wBAChD,MAAM,OAAO,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC,EAAE,EAAE,KAAK,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC,EAAE,EAAE;wBAChF,IAAI,QAAQ,WAAW,QAAQ;wBAC/B,IAAG,OAAO,MAAM,QAAQ,WAAW,MAAM;6BACpC,IAAG,OAAO,MAAM,QAAQ,WAAW,SAAS;wBAEjD,+JAAC,CAAC,MAAM,CAAC;4BAAC;4BAAK;yBAAI,EAAE;4BAAE,QAAQ;4BAAK,OAAO;4BAAQ,WAAW;4BAAO,aAAa;wBAAI,GAAG,KAAK,CAAC;oBAClG;gBACH;;YAEA;YAEA,WAAW,OAAO;8CAAC,CAAC;oBAClB,MAAM,WAAW,UAAU,IAAI;+DAAC,CAAC,MAAQ,IAAI,WAAW,KAAK,UAAU,EAAE,IAAI,IAAI,MAAM,KAAK;;oBAC5F,MAAM,oBAAoB,CAAC,CAAC;oBAE5B,MAAM,OAAO,+JAAC,CAAC,IAAI,CAAC;wBAClB,SAAS,oBACL,20BACA;wBACJ,UAAU;4BAAC;4BAAI;yBAAG;wBAClB,YAAY;4BAAC;4BAAI;yBAAG;wBACpB,aAAa;4BAAC;4BAAG,CAAC;yBAAG;oBACvB;oBAEA,MAAM,SAAS,+JAAC,CAAC,MAAM,CAAC;wBAAC,UAAU,QAAQ,CAAC,QAAQ;wBAAE,UAAU,QAAQ,CAAC,SAAS;qBAAC,EAAE;wBACnF;oBACF,GACG,KAAK,CAAC,KACN,SAAS,CACR,CAAC,QAAQ,EAAE,UAAU,IAAI,CAAC,cAAc,EAAE,4IAAkB,CAAC,UAAU,MAAM,CAAC,EAAE;oBAGpF,WAAW,GAAG,CAAC,UAAU,EAAE,EAAE;gBAC/B;;YAEA,WAAW;QACb;qCAAG;QAAC;QAAK;QAAY;KAAU;IAE/B,qBACE,6LAAC;QAAI,WAAW,aAAa;kBAC3B,cAAA,6LAAC;YAAI,IAAG;YAAsB,WAAU;;;;;;;;;;;AAG9C;GAlFgB;KAAA"}}]
}